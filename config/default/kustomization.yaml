apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

resources:
- ../crd
- namespace.yaml
- ../manager
- ../rbac
- ../certmanager

patches:
- path: manager_auth_proxy_patch.yaml
  target:
    kind: Deployment
    name: controller-manager
- path: manager_config_patch.yaml
  target:
    kind: Deployment
    name: controller-manager
- path: manager_webhook_patch.yaml
  target:
    kind: Deployment
    name: controller-manager

configMapGenerator:
- name: manager-config
  files:
  - controller_manager_config.yaml

namespace: postgres-operator-system
namePrefix: postgres-operator-

labels:
- pairs:
    app.kubernetes.io/name: postgres-operator
    app.kubernetes.io/instance: default
    app.kubernetes.io/component: controller

images:
- name: controller
  newName: localhost:5000/postgres-operator
  newTag: latest